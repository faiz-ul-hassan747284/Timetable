<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        TimeTable for today
    </title>
    <link rel="icon" href="time.png">
</head>

<body>
    <link rel="stylesheet" href="style.css">
    <!-- <script lang="javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script> -->
    <!-- <script>
/* set up XMLHttpRequest */
var url = "timetable.xlsx";
var oReq = new XMLHttpRequest();
oReq.open("GET", url, true);
oReq.responseType = "arraybuffer";

oReq.onload = function(e) {
  var arraybuffer = oReq.response;

  /* convert data to binary string */
  var data = new Uint8Array(arraybuffer);
  var arr = new Array();
  for(var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
  var bstr = arr.join("");

  /* Call XLSX */
  var workbook = XLSX.read(bstr, {type:"binary"});

  /* DO SOMETHING WITH workbook HERE */
  var first_sheet_name = workbook.SheetNames[0];
  /* Get worksheet */
  var worksheet = workbook.Sheets[first_sheet_name];
  console.log(XLSX.utils.sheet_to_json(worksheet,{raw:true}));
}

oReq.send();
    </script> -->
    <div class="contaniner">
        <ul class="cards">
            <script type="text/javascript">

                var myDate = new Date();
                var myDay = myDate.getDay();
                var hours = myDate.getHours();
                // Array of days.
                var timing = ['09:00-09:50', '10:00-10:50', '11:00-11:50', '12:00-12:50', '2:00-2:50', '3:00-3:50', '4:00-4:50']
                var lectures = {
                    0: [['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"]],
                    1:
                        [
                            ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"]],
                    2: [
                        ['None', "None"], ['None', "None"], ['None', "None"], ['Open Source System', "Cr-16 IEAC"], ['None', "None"], ['None', "None"], ['None', "None"]
                    ],
                    3: [
                        ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['Community Service Learning', "SEECS Seminar Hall"], ['Community Service Learning', "SEECS Seminar Hall"], ['Community Service Learning', "SEECS Seminar Hall"]
                    ],
                    4: [
                        ['Organizational Behavior', "Cr-2"], ['None', "None"], ['None', "None"], ['None', "None"], ['Open Source System Lab', "Computing Lab 3"], ['Open Source System', "Computing Lab 3"], ['Open Source System', "Computing Lab 3"]
                    ],
                    6: [
                    ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"], ['None', "None"]
                    ],
                    5: [
                        ['Organizational Behavior', "Cr-02"], ['Organizational Behavior', "Cr-02"], ['Open Source System', "Cr-16 IEAC"], ['Open Source System', "Cr-16 IEAC"], ['None', "None"], ['None', "None"], ['None', "None"]]
                }
                var weekday = ['Sunday', 'Monday', 'Tuesday',
                    'Wednesday', 'Thursday', 'Friday', 'Saturday'
                ];

                document.write("<h3>Today is : " + weekday[myDay] + "</h3>");

                if (hours > 17) {
                    myDay = (myDay + 1) % 7

                    document.write('<h2 class="title">Time Table for tomorrow</h2>')
                }
                var todayLecture = lectures[myDay]

                var i;
                if ([0, 6].includes(myDay)) { document.write('<h2 class="title">Aj to Maaf kro theeton</h2>') }
                else {


                    for (i = 0; i < todayLecture.length; i++) {
                        var code = '<li style="width:70%"><img src="https://picsum.photos/200?random=' + Math.random() + '"/> <div class="details"><span class="name">' + todayLecture[i][0] + '</span><span class="title">Time: ' + timing[i] + '</span><span class="title">Class-room: ' + todayLecture[i][1] + '</span></div></li><br>';
                        document.write(code);
                    }
                }


                // get hour value. 
                var hours = myDate.getHours();
                var ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                hours = hours ? hours : 12;
                var minutes = myDate.getMinutes();
                minutes = minutes < 10 ? '0' + minutes : minutes;
                var myTime = hours + " " + ampm + " : " + minutes + " minutes";
                document.write("\tCurrent time is : " + myTime);
            </script>
        </ul>
    </div>
</body>

</html>